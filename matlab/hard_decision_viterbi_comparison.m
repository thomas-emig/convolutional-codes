% viterbi simulation results - 800.000.000 bits per error rate, block length: 40
% code P0 = (1, 0, 1), P1 = (0, 1, 1)
ber_coded_a = [0.000000 0.000000 0.000000 0.000001 0.000024 0.000616 0.002431 0.009545 0.014733 0.035913 0.120755 0.227862 0.298730 0.445908 0.480994 0.493111 0.493863];
% code P0 = (1, 0, 1, 1), P1 = (1, 1, 1, 0)
ber_coded_b = [0.000000 0.000000 0.000002 0.000010 0.000051 0.000330 0.000848 0.002472 0.003602 0.008331 0.031064 0.072438 0.112608 0.299624 0.414149 0.465758 0.469379];
% code P0 = (1, 0, 1, 0, 1) P1 = (1, 1, 1, 1, 0)
ber_coded_c = [0.000000 0.000000 0.000001 0.000007 0.000039 0.000239 0.000599 0.001741 0.002551 0.006114 0.026200 0.069603 0.115543 0.326379 0.430994 0.472725 0.475711];
% code P0 = (1, 0, 1, 1, 0, 1) P1 = (1, 1, 1, 0, 1, 0)
ber_coded_d = [0.000000 0.000000 0.000001 0.000002 0.000013 0.000093 0.000270 0.000962 0.001532 0.004366 0.023669 0.069840 0.119863 0.338624 0.435971 0.473404 0.476187];
% code P0 = (1, 0, 1), P1 = (1, 1, 0), P2 = (0, 0, 1)
ber_coded_e = [0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000003 0.000021 0.000043 0.000182 0.001618 0.006817 0.015133 0.120716 0.290245 0.413025 0.422798];
ber_uncoded = [0.000001 0.000005 0.000025 0.000125 0.000625 0.003125 0.006250 0.012500 0.015625 0.025000 0.050000 0.078125 0.100000 0.200000 0.300000 0.390625 0.400000];

% stack simulation results - 800.000.000 bits per error rate, block length: 40
% code P0 = (1, 0, 1), P1 = (0, 1, 1)
ber_coded_a_stack = [0.000000 0.000000 0.000000 0.000001 0.000024 0.000611 0.002450 0.009575 0.014738 0.036107 0.123412 0.237964 0.314265 0.457265 0.484362 0.493996 0.494693];
% code P0 = (1, 0, 1, 1), P1 = (1, 1, 1, 0)
ber_coded_b_stack = [0.000000 0.000001 0.000003 0.000018 0.000092 0.000540 0.001283 0.003442 0.004879 0.010804 0.039879 0.092896 0.141463 0.331990 0.431215 0.474183 0.477229];
% code P0 = (1, 0, 1, 0, 1) P1 = (1, 1, 1, 1, 0)
ber_coded_c_stack = [0.000000 0.000001 0.000003 0.000014 0.000074 0.000425 0.000999 0.002704 0.003889 0.009174 0.039028 0.097761 0.152232 0.352449 0.440476 0.476064 0.478641];
% code P0 = (1, 0, 1, 1, 0, 1) P1 = (1, 1, 1, 0, 1, 0)
ber_coded_d_stack = [0.000000 0.000000 0.000001 0.000004 0.000020 0.000140 0.000405 0.001496 0.002428 0.007415 0.041130 0.108750 0.168769 0.367061 0.445325 0.476898 0.479283];
% code P0 = (1, 0, 1), P1 = (1, 1, 0), P2 = (0, 0, 1)
ber_coded_e_stack = [0.000000 0.000000 0.000000 0.000000 0.000000 0.000001 0.000006 0.000035 0.000064 0.000241 0.001934 0.008495 0.020512 0.165905 0.329443 0.430206 0.438133];
% code P0 = (10001010110010100000101101001111) P1 = (11100010001111001000011000100111)
% 800.000.000 bits for p <= 0.025, 80.000.000 bits for p > 0.025
ber_coded_f_stack = [0.000000 0.000000 0.000000 0.000000 0.000000 0.000015 0.000123 0.001176 0.002505 0.012061 0.089690 0.210563 0.282880 0.416891 0.458190 0.479715 0.481470];

plot(ber_uncoded, ber_uncoded, '-k', 'DisplayName', 'uncoded');
hold  all;
plot(ber_uncoded, ber_coded_a, '-*m', 'DisplayName', '[(101) (011)] viterbi');
plot(ber_uncoded, ber_coded_a_stack, '--om', 'DisplayName', '[(101) (011)] stack');
plot(ber_uncoded, ber_coded_b, '-*c', 'DisplayName', '[(1011) (1110)] viterbi');
plot(ber_uncoded, ber_coded_b_stack, '--oc', 'DisplayName', '[(1011) (1110)] stack');
plot(ber_uncoded, ber_coded_c, '-*r', 'DisplayName', '[(10101) (11110)] viterbi');
plot(ber_uncoded, ber_coded_c_stack, '--or', 'DisplayName', '[(10101) (11110)] stack');
plot(ber_uncoded, ber_coded_d, '-*g', 'DisplayName', '[(101101) (111010)] viterbi');
plot(ber_uncoded, ber_coded_d_stack, '--og', 'DisplayName', '[(101101) (111010)] stack');
plot(ber_uncoded, ber_coded_e, '-*b', 'DisplayName', '[(101) (110) (001)] viterbi');
plot(ber_uncoded, ber_coded_e_stack, '--ob', 'DisplayName', '[(101) (110) (001)] stack');
plot(ber_uncoded, ber_coded_f_stack, '--ok', 'DisplayName', 'WSPR code stack');
grid on;
set(gca, 'YScale', 'log');
set(gca, 'XScale', 'log');
xlabel('Channel Bit Error Rate');
ylabel('Coded Bit Error Rate');
legend('Location', 'northwest');
